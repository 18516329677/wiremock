
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Stubbing | WireMock</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css"/>
    <link rel="stylesheet" href="_static/yammerdoc.css" type="text/css"/>
    <link rel="top" title="WireMock" href="index.html"/>
    <link rel="next" title="Verifying" href="verifying.html"/>
    <link rel="prev" title="Getting Started" href="getting-started.html"/>
    <style lang="text/css">
        #top-bar, #top-bar small, #top-bar a {
            text-shadow: 0px 0px 0px #8CA8BB;
            color: #333;
        }
        
        #top-bar {
            background-color: #363F45;
            background-image: -moz-linear-gradient(top, #CCC, #8CA8BB);
            background-image: -ms-linear-gradient(top, #CCC, #8CA8BB);
            background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#CCC), to(#8CA8BB));
            background-image: -webkit-linear-gradient(top, #CCC, #8CA8BB);
            background-image: -o-linear-gradient(top, #CCC, #8CA8BB);
            background-image: linear-gradient(top, #CCC, #8CA8BB);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#CCC', endColorstr = '#8CA8BB', GradientType = 0);
            -webkit-border-radius: 0;
            -moz-border-radius: 0;
            border-radius: 0;
        }


        .hero-unit {
            background-image: url("_static/logo.png") !important;
            background-repeat: no-repeat !important;
            background-position: 30px 50px;
        }

        .hero-unit div.section {
            padding-left: 150px !important;
        }
    </style>

    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-36386229-2']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>
</head>
<body>
    <a href="https://github.com/tomakehurst/wiremock">
        <img style="position: absolute; top: 0; right: 0; border: 0;"
             src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
             alt="Fork me on GitHub"></a>
    <div class="navbar">
        <div class="navbar-inner container-fluid" id="top-bar">
            <header class="row-fluid">
                <h1 class="span12" id="title">
                    <a href="index.html">WireMock</a>
                    <small>A web service test double for all occasions</small>
                </h1>
            </header>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span3" id="sidebar">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Stubbing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-stubbing">Basic stubbing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#url-matching">URL matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="#request-header-matching">Request header matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="#request-body-matching">Request body matching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#json-body-matching">JSON body matching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stub-priority">Stub priority</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sending-response-headers">Sending response headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specifying-the-response-body">Specifying the response body</a></li>
<li class="toctree-l2"><a class="reference internal" href="#saving-stubs">Saving stubs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reset">Reset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="verifying.html">Verifying</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxying.html">Proxying</a></li>
<li class="toctree-l1"><a class="reference internal" href="record-playback.html">Record and Playback</a></li>
<li class="toctree-l1"><a class="reference internal" href="stateful-behaviour.html">Stateful Behaviour</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulating-faults.html">Simulating Faults</a></li>
<li class="toctree-l1"><a class="reference internal" href="shutting-down.html">Shutting down</a></li>
</ul>

            </div>
            <div class="span9" id="body">
                
  <div class="section" id="stubbing">
<span id="id1"></span><h1>Stubbing<a class="headerlink" href="#stubbing" title="Permalink to this headline">¶</a></h1>
<p class="rubric">A core feature of WireMock is the ability to return canned HTTP responses for requests matching criteria. These criteria can be
defined in terms of URL, headers and body content.</p>
<div class="section" id="basic-stubbing">
<span id="stubbing-basic-stubbing"></span><h2>Basic stubbing<a class="headerlink" href="#basic-stubbing" title="Permalink to this headline">¶</a></h2>
<p>The following code will configure a response with a status of 200 to be returned when the relative URL exactly
matches <tt class="docutils literal"><span class="pre">/some/thing</span></tt> (including query parameters). The body of the response will be &#8220;Hello world!&#8221; and a
<tt class="docutils literal"><span class="pre">Content-Type</span></tt> header will be sent with a value of <tt class="docutils literal"><span class="pre">text-plain</span></tt>.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">exactUrlOnly</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/some/thing&quot;</span><span class="o">))</span>
            <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">&quot;Content-Type&quot;</span><span class="o">,</span> <span class="s">&quot;text/plain&quot;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">&quot;Hello world!&quot;</span><span class="o">)));</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;/some/thing&quot;</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;/some/thing/else&quot;</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">404</span><span class="o">));</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you&#8217;d prefer to use slightly more BDDish language in your tests you can replace <tt class="docutils literal"><span class="pre">stubFor</span></tt> with <tt class="docutils literal"><span class="pre">givenThat</span></tt>.</p>
</div>
<p>To create the stub described above via the JSON API, the following document can either be posted to
<tt class="docutils literal"><span class="pre">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/new</span></tt> or placed in a file with a <tt class="docutils literal"><span class="pre">.json</span></tt> extension under the
<tt class="docutils literal"><span class="pre">mappings</span></tt> directory:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/some/thing&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
            <span class="s2">&quot;body&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello world!&quot;</span><span class="p">,</span>
            <span class="s2">&quot;headers&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span> <span class="s2">&quot;text/plain&quot;</span>
            <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>HTTP methods currently supported are: <tt class="docutils literal"><span class="pre">GET,</span> <span class="pre">POST,</span> <span class="pre">PUT,</span> <span class="pre">DELETE,</span> <span class="pre">HEAD,</span> <span class="pre">TRACE,</span> <span class="pre">OPTIONS</span></tt>. You can specify <tt class="docutils literal"><span class="pre">ANY</span></tt> if you
want the stub mapping to match on any request method.</p>
</div>
<div class="section" id="url-matching">
<span id="stubbing-url-matching"></span><h2>URL matching<a class="headerlink" href="#url-matching" title="Permalink to this headline">¶</a></h2>
<p>URLs can be matched exactly (as in the example above) or via a regular expression. In Java this is done with the <tt class="docutils literal"><span class="pre">urlMatching()</span></tt>
function:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">put</span><span class="o">(</span><span class="n">urlMatching</span><span class="o">(</span><span class="s">&quot;/thing/matching/[0-9]+&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</pre></div>
</div>
<p>And in JSON via the <tt class="docutils literal"><span class="pre">urlPattern</span></tt> attribute:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;PUT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;urlPattern&quot;</span><span class="o">:</span> <span class="s2">&quot;/thing/matching/[0-9]+&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="request-header-matching">
<span id="stubbing-request-header-matching"></span><h2>Request header matching<a class="headerlink" href="#request-header-matching" title="Permalink to this headline">¶</a></h2>
<p>To match stubs according to request headers:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/with/headers&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">&quot;Content-Type&quot;</span><span class="o">,</span> <span class="n">equalTo</span><span class="o">(</span><span class="s">&quot;text/xml&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">&quot;Accept&quot;</span><span class="o">,</span> <span class="n">matching</span><span class="o">(</span><span class="s">&quot;text/.*&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">&quot;etag&quot;</span><span class="o">,</span> <span class="n">notMatching</span><span class="o">(</span><span class="s">&quot;abcd.*&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">&quot;etag&quot;</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">&quot;2134&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</pre></div>
</div>
<p>Or</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/with/headers&quot;</span><span class="p">,</span>
        <span class="s2">&quot;headers&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;equalTo&quot;</span><span class="o">:</span> <span class="s2">&quot;text/xml&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;Accept&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;matches&quot;</span><span class="o">:</span> <span class="s2">&quot;text/.*&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;etag&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;doesNotMatch&quot;</span><span class="o">:</span> <span class="s2">&quot;abcd.*&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;etag&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;contains&quot;</span><span class="o">:</span> <span class="s2">&quot;2134&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="request-body-matching">
<span id="stubbing-request-body-matching"></span><h2>Request body matching<a class="headerlink" href="#request-body-matching" title="Permalink to this headline">¶</a></h2>
<p>For PUT and POST requests the contents of the request body can be used to match stubs:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/with/body&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matching</span><span class="o">(</span><span class="s">&quot;&lt;status&gt;OK&lt;/status&gt;&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">notMatching</span><span class="o">(</span><span class="s">&quot;.*ERROR.*&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</pre></div>
</div>
<p>Body content can be matched using all the same predicates as for headers: <tt class="docutils literal"><span class="pre">equalTo</span></tt>, <tt class="docutils literal"><span class="pre">matching</span></tt>, <tt class="docutils literal"><span class="pre">notMatching</span></tt>,
<tt class="docutils literal"><span class="pre">containing</span></tt>.</p>
<p>The JSON equivalent of the above example would be:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/with/body&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bodyPatterns&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">&quot;matches&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;status&gt;OK&lt;/status&gt;&quot;</span> <span class="p">},</span>
            <span class="p">{</span> <span class="s2">&quot;doesNotMatch&quot;</span><span class="o">:</span> <span class="s2">&quot;.*ERROR.*&quot;</span> <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="json-body-matching">
<h3>JSON body matching<a class="headerlink" href="#json-body-matching" title="Permalink to this headline">¶</a></h3>
<p>Body content which is valid JSON can be matched on semantically:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/with/json/body&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToJson</span><span class="o">(</span><span class="s">&quot;{ \&quot;houseNumber\&quot;: 4, \&quot;postcode\&quot;: \&quot;N1 1ZZ\&quot; }&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</pre></div>
</div>
<p>JSONPath expressions can also be used:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/with/json/body&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">&quot;$.status&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">&quot;$.things[$(@.name == &#39;RequiredThing&#39;)]&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">201</span><span class="o">)));</span>
</pre></div>
</div>
<p>The path syntax is implemented by the <a class="reference external" href="http://goessner.net/articles/JsonPath/">JSONPath library</a>. A JSON body will be
considered to match a path expression if the expression returns either a non-null single value (string, integer etc.),
or a non-empty object or array.</p>
<p>The JSON equivalent of the above example would be:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/with/json/body&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bodyPatterns&quot;</span> <span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">&quot;matchesJsonPath&quot;</span> <span class="o">:</span> <span class="s2">&quot;$.status&quot;</span><span class="p">},</span>
            <span class="p">{</span> <span class="s2">&quot;matchesJsonPath&quot;</span> <span class="o">:</span> <span class="s2">&quot;$.things[$(@.name == &#39;RequiredThing&#39;)]&quot;</span> <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">201</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All of the request matching options described here can also be used for <a class="reference internal" href="verifying.html#verifying"><em>Verifying</em></a>.</p>
</div>
</div>
</div>
<div class="section" id="stub-priority">
<span id="stubbing-stub-priority"></span><h2>Stub priority<a class="headerlink" href="#stub-priority" title="Permalink to this headline">¶</a></h2>
<p>It is sometimes the case that you&#8217;ll want to declare two or more stub mappings that &#8220;overlap&#8221;, in that a given request
would be a match for more than one of them. By default, WireMock will use the most recently added matching stub to satisfy
the request. However, in some cases it is useful to exert more control.</p>
<p>One example of this might be where you want to define a catch-all stub for any URL that doesn&#8217;t match any more specific cases.
Adding a priority to a stub mapping facilitates this:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="c1">//Catch-all case</span>
<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlMatching</span><span class="o">(</span><span class="s">&quot;/api/.*&quot;</span><span class="o">)).</span><span class="na">atPriority</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">401</span><span class="o">)));</span>

<span class="c1">//Specific case</span>
<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/api/specific-resource&quot;</span><span class="o">)).</span><span class="na">atPriority</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="c1">//1 is highest</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
            <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">&quot;Resource state&quot;</span><span class="o">)));</span>
</pre></div>
</div>
<p>Priority is set via the <tt class="docutils literal"><span class="pre">priority</span></tt> attribute in JSON:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/api/specific-resource&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="sending-response-headers">
<span id="stubbing-sending-response-headers"></span><h2>Sending response headers<a class="headerlink" href="#sending-response-headers" title="Permalink to this headline">¶</a></h2>
<p>In addition to matching on request headers, it&#8217;s also possible to send response headers:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/whatever&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">&quot;Content-Type&quot;</span><span class="o">,</span> <span class="s">&quot;application/json&quot;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">&quot;Cache-Control&quot;</span><span class="o">,</span> <span class="s">&quot;no-cache&quot;</span><span class="o">)));</span>
</pre></div>
</div>
<p>Or</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/whatever&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;headers&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span> <span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cache-Control&quot;</span><span class="o">:</span> <span class="s2">&quot;no-cache&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="specifying-the-response-body">
<span id="stubbing-specifying-the-response-body"></span><h2>Specifying the response body<a class="headerlink" href="#specifying-the-response-body" title="Permalink to this headline">¶</a></h2>
<p>The simplest way to specify a response body is as a string literal:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/body&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">&quot;Literal text to put in the body&quot;</span><span class="o">)));</span>
</pre></div>
</div>
<p>Or</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/body&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;body&quot;</span><span class="o">:</span> <span class="s2">&quot;Literal text to put in the body&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To read the body content from a file, place the file under the <tt class="docutils literal"><span class="pre">__files</span></tt> directory. By default this is expected to
be under <tt class="docutils literal"><span class="pre">src/test/resources</span></tt> when running from the JUnit rule. When running standalone it will be under the current
directory in which the server was started. To make your stub use the file, simply call <tt class="docutils literal"><span class="pre">bodyFile()</span></tt> on the response
builder with the file&#8217;s path relative to <tt class="docutils literal"><span class="pre">__files</span></tt>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/body-file&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBodyFile</span><span class="o">(</span><span class="s">&quot;path/to/myfile.xml&quot;</span><span class="o">)));</span>
</pre></div>
</div>
<p>Or</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/body-file&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;bodyFileName&quot;</span><span class="o">:</span> <span class="s2">&quot;path/to/myfile.xml&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All strings used by WireMock, including the contents of body files are expected to be in <tt class="docutils literal"><span class="pre">UTF-8</span></tt> format. Passing strings
in other character sets, whether by JVM configuration or body file encoding will most likely produce strange behaviour.</p>
</div>
<p>A response body in binary format can be specified as a <tt class="docutils literal"><span class="pre">byte[]</span></tt> via an overloaded <tt class="docutils literal"><span class="pre">body()</span></tt>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">&quot;/binary-body&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span> <span class="o">})));</span>
</pre></div>
</div>
<p>The JSON API accepts this as a base64 string (to avoid stupidly long JSON documents):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;request&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;/binary-body&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;response&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;base64Body&quot;</span> <span class="o">:</span> <span class="s2">&quot;WUVTIElOREVFRCE=&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-stubs">
<span id="stubbing-saving-stubs"></span><h2>Saving stubs<a class="headerlink" href="#saving-stubs" title="Permalink to this headline">¶</a></h2>
<p>Stub mappings which have been created can be persisted to the <tt class="docutils literal"><span class="pre">mappings</span></tt> directory via a call to <tt class="docutils literal"><span class="pre">WireMock.saveAllMappings</span></tt>
in Java or posting a request with an empty body to <tt class="docutils literal"><span class="pre">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/save</span></tt>.</p>
<p>Note that this feature is not available when running WireMock from a servlet container.</p>
</div>
<div class="section" id="reset">
<span id="stubbing-reset"></span><h2>Reset<a class="headerlink" href="#reset" title="Permalink to this headline">¶</a></h2>
<p>The WireMock server can be reset at any time, removing all stub mappings and deleting the request log. If you&#8217;re using
either of the JUnit rules this will happen automatically at the start of every test case. However you can do it yourself
via a call to <tt class="docutils literal"><span class="pre">WireMock.reset()</span></tt> in Java or posting a request with an empty body to <tt class="docutils literal"><span class="pre">http://&lt;host&gt;:&lt;port&gt;/__admin/reset</span></tt>.</p>
<p>If you&#8217;ve created some file based stub mappings to be loaded at startup and you don&#8217;t want these to disappear when you
do a reset you can call <tt class="docutils literal"><span class="pre">WireMock.resetToDefault()</span></tt> instead, or post an empty request to
<tt class="docutils literal"><span class="pre">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/reset</span></tt>.</p>
</div>
</div>


            </div>
        </div>
        <hr/>
        <footer>
            &copy; Copyright 2012, Tom Akehurst.
            Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>
            1.1.3.
        </footer>
    </div>
</body>
</html>


